(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{95:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return b}));var r=n(3),a=n(7),i=(n(0),n(99)),o={id:"installation",title:"Installation"},l={unversionedId:"installation",id:"installation",isDocsHomePage:!1,title:"Installation",description:"<div",source:"@site/docs/installation.mdx",slug:"/installation",permalink:"/immer/installation",editUrl:"https://github.com/immerjs/immer/edit/master/website/docs/installation.mdx",version:"current",sidebar:"Immer",previous:{title:"Introduction to Immer",permalink:"/immer/"},next:{title:"Using produce",permalink:"/immer/produce"}},c=[{value:"Pick your Immer version",id:"pick-your-immer-version",children:[]},{value:"Immer on older JavaScript environments?",id:"immer-on-older-javascript-environments",children:[]}],p={toc:c};function b(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("center",null,Object(i.b)("div",{"data-ea-publisher":"immerjs","data-ea-type":"image",className:"horizontal bordered"})),Object(i.b)("p",null,"Immer can be installed as a direct dependency, and will work in any ES5 environment:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Yarn: ",Object(i.b)("inlineCode",{parentName:"li"},"yarn add immer")),Object(i.b)("li",{parentName:"ul"},"NPM: ",Object(i.b)("inlineCode",{parentName:"li"},"npm install immer")),Object(i.b)("li",{parentName:"ul"},"CDN: Exposed global is ",Object(i.b)("inlineCode",{parentName:"li"},"immer"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"Unpkg: ",Object(i.b)("inlineCode",{parentName:"li"},'<script src="https://unpkg.com/immer"><\/script>')),Object(i.b)("li",{parentName:"ul"},"JSDelivr: ",Object(i.b)("inlineCode",{parentName:"li"},'<script src="https://cdn.jsdelivr.net/npm/immer"><\/script>')),Object(i.b)("li",{parentName:"ul"},"\u26a0\ufe0f When using a CDN, it is best to check the url in your browser and see what version it resolves to, so that your users aren't accidentally served a newer version in the future when updates are release. So use an url like: ",Object(i.b)("a",{parentName:"li",href:"https://unpkg.com/immer@6.0.3/dist/immer.umd.production.min.js"},"https://unpkg.com/immer@6.0.3/dist/immer.umd.production.min.js")," instead. Substitute ",Object(i.b)("inlineCode",{parentName:"li"},"production.min")," with ",Object(i.b)("inlineCode",{parentName:"li"},"development")," in the URL for a development build.")))),Object(i.b)("h2",{id:"pick-your-immer-version"},"Pick your Immer version"),Object(i.b)("p",null,Object(i.b)("em",{parentName:"p"},"This section only applies to version 6 and later")),Object(i.b)("p",null,"To make sure Immer is as small as possible, features that are not required by every project has been made opt-in, and have to be enabled explicitly. This ensures that when bundling your application for production, unused features don't take any space."),Object(i.b)("p",null,"The following features can be opt-in to:"),Object(i.b)("table",null,Object(i.b)("thead",{parentName:"table"},Object(i.b)("tr",{parentName:"thead"},Object(i.b)("th",{parentName:"tr",align:null},"Feature"),Object(i.b)("th",{parentName:"tr",align:null},"Description"),Object(i.b)("th",{parentName:"tr",align:null},"Method to call"))),Object(i.b)("tbody",{parentName:"table"},Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:null},"ES 5 support"),Object(i.b)("td",{parentName:"tr",align:null},"If your application needs to be able to run on older JavaScript environments, such as Internet Explorer or React Native, enable this feature."),Object(i.b)("td",{parentName:"tr",align:null},Object(i.b)("inlineCode",{parentName:"td"},"enableES5()"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:null},Object(i.b)("a",{parentName:"td",href:"/immer/complex-objects"},"ES2015 Map and Set support")),Object(i.b)("td",{parentName:"tr",align:null},"To enable Immer to operate on the native ",Object(i.b)("inlineCode",{parentName:"td"},"Map")," and ",Object(i.b)("inlineCode",{parentName:"td"},"Set")," collections, enable this feature"),Object(i.b)("td",{parentName:"tr",align:null},Object(i.b)("inlineCode",{parentName:"td"},"enableMapSet()"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:null},Object(i.b)("a",{parentName:"td",href:"/immer/patches"},"JSON Patch support")),Object(i.b)("td",{parentName:"tr",align:null},"Immer can keep track of all the changes you make to draft objects. This can be useful for communicating changes using JSON patches"),Object(i.b)("td",{parentName:"tr",align:null},Object(i.b)("inlineCode",{parentName:"td"},"enablePatches()"))),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",{parentName:"tr",align:null},Object(i.b)("strong",{parentName:"td"},"All of the above")),Object(i.b)("td",{parentName:"tr",align:null},"Unsure what features you need? We recommend to enable all of the features above by default on new projects. Premature optimization of a few KB might not be worth the initial trouble. Also, enabling or disabling features doesn't impact the performance of Immer itself"),Object(i.b)("td",{parentName:"tr",align:null},Object(i.b)("inlineCode",{parentName:"td"},"enableAllPlugins()"))))),Object(i.b)("p",null,"For example, if you want to use ",Object(i.b)("inlineCode",{parentName:"p"},"produce")," on a ",Object(i.b)("inlineCode",{parentName:"p"},"Map"),", you need to enable this feature once during the start of your application:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-typescript"},'// In your application\'s entrypoint\nimport {enableMapSet} from "immer"\n\nenableMapSet()\n\n// ...later\nimport produce from "immer"\n\nconst usersById_v1 = new Map([\n    ["michel", {name: "Michel Weststrate", country: "NL"}]\n])\n\nconst usersById_v2 = produce(usersById_v1, draft => {\n    draft.get("michel").country = "UK"\n})\n\nexpect(usersById_v1.get("michel").country).toBe("NL")\nexpect(usersById_v2.get("michel").country).toBe("UK")\n')),Object(i.b)("p",null,"Vanilla Immer kicks in at ~3KB gzipped. Every plugin that is enabled adds < 1 KB to that. The breakdown is as follows:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"Import size report for immer:\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502        (index)        \u2502 just this \u2502 cumulative \u2502 increment \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 import * from 'immer' \u2502   5662    \u2502     0      \u2502     0     \u2502\n\u2502        produce        \u2502   3100    \u2502    3100    \u2502     0     \u2502\n\u2502       enableES5       \u2502   3761    \u2502    3770    \u2502    670    \u2502\n\u2502     enableMapSet      \u2502   3885    \u2502    4527    \u2502    757    \u2502\n\u2502     enablePatches     \u2502   3891    \u2502    5301    \u2502    774    \u2502\n\u2502   enableAllPlugins    \u2502   5297    \u2502    5348    \u2502    47     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n(this report was generated by npmjs.com/package/import-size)\n")),Object(i.b)("h2",{id:"immer-on-older-javascript-environments"},"Immer on older JavaScript environments?"),Object(i.b)("p",null,"By default ",Object(i.b)("inlineCode",{parentName:"p"},"produce")," tries to use proxies for optimal performance. However, on older JavaScript engines ",Object(i.b)("inlineCode",{parentName:"p"},"Proxy")," is not available. For example, when running Microsoft Internet Explorer or React Native (if < v0.59 or when using the Hermes engine on React Native < 0.64) on Android. In such cases, Immer will fallback to an ES5 compatible implementation which works identically, but is a bit slower."),Object(i.b)("p",null,"Since version 6, support for the fallback implementation has to be explicitly enabled by calling ",Object(i.b)("inlineCode",{parentName:"p"},"enableES5()"),"."))}b.isMDXComponent=!0},99:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return d}));var r=n(0),a=n.n(r);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=a.a.createContext({}),b=function(e){var t=a.a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},m=function(e){var t=b(e.components);return a.a.createElement(p.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},u=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),m=b(n),u=r,d=m["".concat(o,".").concat(u)]||m[u]||s[u]||i;return n?a.a.createElement(d,l(l({ref:t},p),{},{components:n})):a.a.createElement(d,l({ref:t},p))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return a.a.createElement.apply(null,o)}return a.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);